<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<meta name="format-detection" content="telephone=no">
		<meta name="description" content="港货灵是一套分销系统，港货灵VIP获得超低价购买，VIP推荐用户成为VIP获得100元奖励，推荐用户购买获得利润的40%分成，推荐厂家产品给产品的所有销售的利润的5%分成，成为区域公司获得该区域下所有消费的利润5%分成。是一个最好的系统" />
		<meta name="keywords" content="港货灵分销，港货灵VIP获得超低价购买" />
		<title>港货灵</title>
		<link rel="stylesheet" href="/h5/data/assets/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="/h5/data/assets/bootstrap/css/font-awesome.min.css">
		<link rel="stylesheet" href="/h5/data/assets/swiper/css/swiper.min.css" />
		<link rel="stylesheet" href="/h5/themes/default/statics/css/ectouch.css" />
		<link rel="stylesheet" href="/h5/themes/default/css/photoswipe.css">
		<link rel="stylesheet" href="/h5/themes/default/css/style.css">
		<script type="text/javascript" src="/h5/themes/default/js/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="/h5/themes/default/js/ectouch.js"></script>
		<link rel="stylesheet" href="/h5/themes/default/statics/css/search.css" />
		<script type="text/javascript">
			var tpl = '/ectouch/wsc/themes/default';
		</script>

	</head>

	<body>
		<form id="uorderitemids">
		<div hidden th:each="item:${itemList}" >
			<input hidden name="uorderitemid" th:value='${item.uorderitemid}'>
		</div>
		</form>
		<div class="con">
			<div class="ect-bg">
				<header class="ect-header ect-margin-tb ect-margin-lr text-center ect-bg icon-write">
					<a href="javascript:history.go(-1)" class="pull-left ect-icon ect-icon1 ect-icon-history"></a> <span>购物车</span>
					<a href="javascript:;" onClick="openMune()" class="pull-right ect-icon ect-icon1 ect-icon-mune icon-write"></a>
				</header>
				<nav class="ect-nav ect-nav-list" style="display:none;">
					<ul class="ect-diaplay-box text-center">
						<li class="ect-box-flex">
							<a href="/h5/index" style="font-size:1.4rem"><i class="ect-icon ect-icon-home"></i>首页</a>
						</li>
						<li class="ect-box-flex">
							<a href="/h5/category/" style="font-size:1.4rem"><i class="ect-icon ect-icon-cate"></i>分类</a>
						</li>
						<li class="ect-box-flex">
							<a href="javascript:;" style="font-size:1.4rem" class="j-search-input"><i class="ect-icon ect-icon-search"></i>搜索</a>
						</li>
						<li class="ect-box-flex">
							<a href="#" style="font-size:1.4rem"><i class="ect-icon ect-icon-flow"></i>购物车</a>
						</li>
						<li class="ect-box-flex">
							<a href="/h5/personal_center/" style="font-size:1.4rem"><i class="ect-icon ect-icon-user"></i>我的</a>
						</li>
					</ul>
				</nav>
			</div>
			<p class="flow-price ect-padding-lr ect-padding-tb"> 共<b id="total_number" th:text="${order?.uproductnum}">1</b>件商品，总价(不含运费)：<b class="ect-colory" id="goods_subtotal" th:text="'￥'+${order?.upayprice}+'元'">￥8758.00元</b> </p>
			<section class="ect-pro-list flow-pic ect-border-bottom0">
				<ul>
					<li class="n-flow1-box">
						<!--<div class="j-chack-box n-flow-ckecked">
					<div class="chack-input-box">
						<label><input type="checkbox" name="bike" /></label>
					</div>
				</div>-->
						<div class="n-flow-right-sum" th:each="item:${itemList}">
							<div class="ect-clear-over">

								<a href="/ectouch/wsc/index.php?m=default&c=goods&a=index&id=7729&u=35172" th:href="'/h5/goods/' + ${item.ucomproductid}"><img th:src="${item.uhomepic}" th:title="${item.uproductname}" onerror="this.src='/h5/themes/default/images/not_goods.png'" title="Apple/苹果 配备 Retina 显示屏的 MacBook Pro ME864CH/A"></a>

								<dl>
									<dt>

							  <h4 class="title"><a href="/ectouch/wsc/index.php?m=default&c=goods&a=index&id=7729&u=35172" th:href="'/h5/goods/' + ${item.ucomproductid}" th:text="${item.uproductname}">Apple/苹果 配备 Retina 显示屏的 MacBook Pro ME864CH/A

								</a></h4>
							</dt>
									<dd class="ect-color999">
										<p th:text="${item.uobjnamevalue}"></p>
										<p><strong class="ect-colory" th:text="|￥${item.uprice}元|">￥8758.00元</strong></p>
									</dd>
								</dl>
							</div>
							<div class="ect-margin-tb ect-margin-bottom0 ect-clear-over flow-num-del">
								<div class="input-group pull-left wrap">
									<span class="input-group-addon" th:onclick="'javascript:change_goods_number(1,\''+${item.uorderitemid}+'\')'"  onClick="change_goods_number('1',1088)">-</span>
									<input type="hidden" th:id="|back_number${item.uorderitemid}|" value="1" />
									<input type="text" th:id="|goods_number${item.uorderitemid}|" class="form-num form-contro" th:name="${item.uorderitemid}" name="1088" id="goods_number1088" autocomplete="off" th:value="${item.uproductnum}" value="1" th:onfocus="'javascript:back_goods_number(\''+${item.uorderitemid}+'\')'" onFocus="back_goods_number(1088)" th:onblur="'javascript:change_goods_number(2,\''+${item.uorderitemid}+'\')'" onblur="change_goods_number('2',1088)" />
									<span class="input-group-addon" th:onclick="'javascript:change_goods_number(3,\''+${item.uorderitemid}+'\')'" onClick="change_goods_number('3',1088)">+</span>
								</div>

								<div class="pull-right">
									<a href="javascript:if (confirm('您确实要把该商品移出购物车吗？')) location.href='/h5/cart/';" th:href="'javascript:if (confirm(\'您确实要把该商品移出购物车吗？\')) location.href=\'/h5/cart/remove/'+${item.uorderitemid}+'\''"><img class="n-shanchutupian" src=/h5/themes/default/images/iconfont-xiao1.png style="width:1.5rem;height:1.5rem;margin-right:0.5rem;margin-top:0.5rem;"></a>
								</div>
							</div>
						</div>
					</li>
				</ul>
			</section>
			<div class="flow-jiesuan ect-padding-lr ect-padding-tb" style="background: #f7f7f7;">
				<a href="/h5/order/checkout" type="button" class="btn btn-info ect-btn-info ect-bg">立即结算</a>
			</div>
		</div>


		<script>
			$(".n-flow1-box").click(function() {
				var n_flow1_box = $(this).find(".n-flow-ckecked label");
				if(n_flow1_box.hasClass("active")) {
					n_flow1_box.removeClass("active");
				} else {
					n_flow1_box.addClass("active");
				}
			});
		</script>

		<div class="search-div ts-3">
			<section class="search">
				<form action="/ectouch/wsc/index.php?m=default&c=category&a=index&u=35172" method="post">
					<div class="text-all dis-box j-text-all">
						<a class="a-icon-back j-close-search" href="javascript:history.go(-1)"><i class="iconfont icon-jiantou is-left-font"></i></a>
						<div class="box-flex input-text">
							<input class="j-input-text" type="text" name="name" placeholder="请输入搜索关键词！" id="newinput" />
							<i class="iconfont icon-guanbi2 is-null j-is-null"></i>
						</div>
						<button type="submit" class="btn-submit">搜索</button>
					</div>
				</form>
			</section>
			<section class="search-con">
				<div class="swiper-scroll history-search">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<p>
								<label class="fl">热门搜索</label>
							</p>
							<ul class="hot-search a-text-more">
								<li class="w-3">
									<a href="/ectouch/wsc/index.php?m=default&c=category&a=index&keywords=%E7%BE%8E%E5%9B%BD&u=35172"><span>美国</span></a>
								</li>
								<li class="w-3">
									<a href="/ectouch/wsc/index.php?m=default&c=category&a=index&keywords=%E6%96%B0%E7%94%9F%E5%A9%B4%E5%84%BF&u=35172"><span>新生婴儿</span></a>
								</li>
							</ul>
							<p class="hos-search">
								<label class="fl">最近搜索</label>
								<span class="fr" onclick="javascript:clearHistroy();"><i class="iconfont icon-xiao10 is-xiao10 jian-top fr"></i></span>
							</p>

							<ul class="hot-search a-text-more a-text-one" id="search_histroy">
								<li>
									<a href="/ectouch/wsc/index.php?m=default&c=category&a=index&keywords=%E7%BE%8E%E5%9B%BD&u=35172"><span>美国</span></a>
								</li>
							</ul>
						</div>
					</div>
					<div class="swiper-scrollbar"></div>
				</div>
			</section>
			<footer class="close-search j-close-search">
				点击关闭
			</footer>
		</div>

		<script type="text/javascript">
			//设置cookie
			function setCookie(cname, cvalue, exdays) {
				var d = new Date();
				d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
				var expires = "expires=" + d.toUTCString();
				document.cookie = cname + "=" + cvalue + "; " + expires;
			}

			function clearHistroy() {
				setCookie('ECS[keywords]', '', -1);
				document.getElementById("search_histroy").style.visibility = "hidden";
			}
		</script>
		<script type="text/javascript" src="/h5/data/assets/js/jquery.min.js"></script>
		<script type="text/javascript" src="/h5/data/assets/js/jquery.json.js"></script>
		<script type="text/javascript" src="/h5/data/assets/js/common.js"></script>
		<script type="text/javascript" src="/h5/data/assets/js/jquery.more.js"></script>
		<script type="text/javascript" src="/h5/data/assets/js/utils.js"></script>
		<script src="/h5/data/assets/swiper/js/jquery.swiper.min.js"></script>
		<script src="/h5/themes/default/js/ectouch.js"></script>
		<script src="/h5/themes/default/js/simple-inheritance.min.js"></script>
		<script src="/h5/themes/default/js/code-photoswipe-1.0.11.min.js"></script>
		<script src="/h5/data/assets/bootstrap/js/bootstrap.min.js"></script>
		<script src="/h5/themes/default/js/jquery.scrollUp.min.js"></script>
		<script type="text/javascript" src="/h5/data/assets/js/validform.js"></script>
		<script type="text/javascript" src="/h5/themes/default/statics/js/ectouch.js"></script>
		<script language="javascript">
			var handler = function(e) { //禁止浏览器默认行为
				e.preventDefault();
			};
			/*banner滚动图片*/
			var swiper = new Swiper('.swiper-container', {
				pagination: '.swiper-pagination',
				slidesPerView: 1,
				loop: true,
				autoplay: 2000
			});
			/*弹出评论层并隐藏其他层*/
			function openSearch() {
				document.addEventListener("touchmove", handler, false);
				$("body").addClass("show-search-div");
				$(".search-div").css("z-index", "4999");
				$("input[name='keywords']").focus();
			}
		</script>
		<script type="text/javascript" src="/h5/data/assets/js/shopping_flow.js"></script>

		<script>
			function back_goods_number(id) {
				var goods_number = document.getElementById('goods_number' + id).value;
				document.getElementById('back_number' + id).value = goods_number;
			}

			function change_goods_number(type, id) {
				var goods_number = document.getElementById('goods_number' + id).value;
				if(type != 2) {
					back_goods_number(id)
				}
				if(type == 1) {
					goods_number--;
				}
				if(type == 3) {
					goods_number++;
				}
				if(goods_number <= 0) {
					goods_number = 1;
				}
				if(!/^[0-9]*$/.test(goods_number)) {
					goods_number = document.getElementById('back_number' + id).value;
				}
				document.getElementById('goods_number' + id).value = goods_number;
				$.post('/h5/cart/changeNumber', {
                    uorderitemid: id,
                    uproductnum: goods_number
				}, function(result) {

					change_goods_number_response(result, id);
				}, 'json');
			}
			// 处理返回信息并显示
			function change_goods_number_response(result, id) {
				if(result.retcode == 1) {
                    var data = result.data;
					var rec_id = result.rec_id;
					$("#goods_number_" + id).val(data.uproductnum);
					document.getElementById('total_number').innerHTML = data.uproducttotalnum; //更新数量
					document.getElementById('goods_subtotal').innerHTML =  "￥"+(data.totalPayprice)+"元"; //更新小计
					if(document.getElementById('ECS_CARTINFO')) {
						//更新购物车数量
						document.getElementById('ECS_CARTINFO').innerHTML = result.cart_info;
					}
				} else {
					alert(result.retmsg);
					var goods_number = document.getElementById('back_number' + id).value;
					document.getElementById('goods_number' + id).value = goods_number;
				}
			}

			/*点击下拉手风琴效果*/
			$('.collapse').collapse()
			$(".checkout-select a").click(function() {
				if(!$(this).hasClass("select")) {
					$(this).addClass("select");
				} else {
					$(this).removeClass("select");
				}
			});

			$("#jiesuan").on("click",function () {
               var data =  $("#uorderitemids").serialize();
                $.ajax({
                    type: "post",
					data: data,
                    url: "/h5/order/checkout",
                    success: function (respMsg) {
                        var data = respMsg.data;

                        if (respMsg.retcode == 3) {
                            // windows.href("/h5/takeAddress/list");
                        }


                    },
                    error: function () {
                        alert("失败!");
                    }
                });

            })

		</script>
	</body>
</html>